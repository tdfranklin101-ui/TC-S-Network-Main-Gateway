<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TC-S Generator Protocol — Beta Prototype</title>
  <link rel="stylesheet" href="styles.css">
  <script defer src="app.js"></script>
</head>
<body>
  <div class="prototype-banner">
    ⚠️ Prototype / Mockup — NOT LIVE • No real transactions. For internal testing only.
  </div>

  <header class="site-header">
    <div class="brand">The Current-See</div>
    <nav><a href="home.html">Home</a></nav>
  </header>

  <main class="container">
    <section class="intro">
      <h1>Generator Protocol (Beta)</h1>
      <p class="lede">Verify energy → tokenize (REC/CC) → distribute value to people, merchants, and communities.</p>
      <ul class="checks">
        <li>✅ Verified renewable generation</li>
        <li>✅ Automatic tokenization</li>
        <li>✅ Transparent wealth distribution</li>
      </ul>
    </section>

    <section class="card">
      <h2>1) Onboard Your Facility</h2>
      <form id="onboardForm">
        <div class="row">
          <label>Generator Name
            <input type="text" name="generatorName" id="generatorName" placeholder="Sunny Ridge Solar" required>
          </label>
          <label>Location / Grid Region
            <input type="text" name="location" id="location" placeholder="US-CA-CAISO" required>
          </label>
        </div>

        <div class="row">
          <label>Technology
            <select name="tech" id="tech" required>
              <option value="">Select…</option>
              <option>solar_pv</option><option>wind</option><option>hydro</option>
              <option>geothermal</option><option>biomass</option>
            </select>
          </label>
          <label>Capacity (kW)
            <input type="number" min="1" step="1" name="capacityKw" id="capacityKw" placeholder="500" required>
          </label>
          <label>Est. Annual Output (MWh)
            <input type="number" min="0" step="0.01" name="estMwh" id="estMwh" placeholder="1000.00" required>
          </label>
        </div>

        <div class="row">
          <label>Grid Emission Factor (tCO₂e/MWh)
            <input type="number" min="0" step="0.001" name="gridEF" id="gridEF" placeholder="0.45" required>
          </label>
          <label>REC Split (%)
            <input id="recPct" type="number" min="0" max="100" step="1" name="recPct" value="55" required>
          </label>
          <label>CC Split (%)
            <input id="ccPct" type="number" min="0" max="100" step="1" name="ccPct" value="45" required>
          </label>
        </div>

        <div class="row">
          <label>Commissioner Present?
            <select name="commissionerPresent" id="commissionerPresent" required>
              <option value="">Select…</option>
              <option value="yes">Yes — Private Network</option>
              <option value="no">No — Generator as Commissioner</option>
            </select>
          </label>
          <label id="noCommModeWrap" class="hidden">No-Commissioner Mode
            <select name="noCommissionerMode" id="noCommissionerMode">
              <option value="KEEP">Keep commissioner portion</option>
              <option value="DONATE_GBI">Donate to TC-S GBI (REC purchase → Solar Rays distribution)</option>
            </select>
          </label>
        </div>

        <div class="row">
          <label>Payout USD (%)
            <input id="usdPct" type="number" min="0" max="100" step="1" name="usdPct" value="70" required>
          </label>
          <label>Payout Solar Rays (%)
            <input id="raysPct" type="number" min="0" max="100" step="1" name="raysPct" value="30" required>
          </label>
        </div>

        <label class="checkbox">
          <input type="checkbox" required>
          <span>I understand this is a prototype. No real trades or payments.</span>
        </label>

        <div class="actions">
          <button type="submit" class="btn primary">Preview Calculations (Mock)</button>
          <button type="button" id="saveMock" class="btn">Save Locally (Mock)</button>
        </div>
      </form>

      <pre id="preview" class="preview hidden"></pre>
    </section>

    <section class="card">
      <h2>2) Sample Period Calculation</h2>
      <form id="calcForm">
        <div class="row">
          <label>Reporting Period (MWh)
            <input type="number" min="0" step="0.01" name="periodMwh" placeholder="1000.00" required>
          </label>
          <label>REC Base ($/REC)
            <input type="number" min="0" step="0.01" name="recBase" placeholder="20.00" required>
          </label>
          <label>REC Market Price ($/REC)
            <input type="number" min="0" step="0.01" name="recPrice" placeholder="28.00" required>
          </label>
        </div>
        <div class="actions">
          <button type="submit" class="btn">Compute Mock Delta</button>
          <!-- NEW: Agreement Buttons -->
          <button type="button" id="openPpa" class="btn secondary">Open PPA (Mock)</button>
          <button type="button" id="openRecPa" class="btn secondary">Open REC Purchase Agreement (Mock)</button>
        </div>
      </form>
      <pre id="calcPreview" class="preview hidden"></pre>
    </section>

    <section class="card faint">
      <h2>About this Prototype</h2>
      <p>TC-S is software that facilitates verification, tokenization, and transparent distribution. TC-S does not fund transactions or act as a financial counterparty. All market purchases and sales are third-party. This page is a <b>mockup</b> for internal testing.</p>
    </section>
  </main>

  <footer class="site-footer">
    <p>© The Current-See PBC, Inc. • Prototype only • Do not rely on outputs</p>
  </footer>

  <!-- ========== PPA MODAL ========== -->
  <div class="modal hidden" id="ppaModal" aria-hidden="true">
    <div class="modal-card">
      <div class="modal-head">
        <h3>PPA — Power Purchase Agreement (Prototype)</h3>
        <button class="icon" data-close="ppaModal" aria-label="Close">✕</button>
      </div>
      <div class="modal-body">
        <form id="ppaForm">
          <div class="row">
            <label>Generator
              <input type="text" id="ppaGenerator" required>
            </label>
            <label>Location / Grid
              <input type="text" id="ppaLocation" required>
            </label>
            <label>Technology
              <input type="text" id="ppaTech" required>
            </label>
          </div>

          <div class="row">
            <label>Base Price ($/REC)
              <input type="number" id="ppaBase" min="0" step="0.01" placeholder="20.00" required>
            </label>
            <label>REC % Allocation
              <input type="number" id="ppaRecPct" min="0" max="100" step="1" required>
            </label>
            <label>CC % Allocation
              <input type="number" id="ppaCcPct" min="0" max="100" step="1" required>
            </label>
          </div>

          <p class="small">
            TC-S acts as a software facilitator only. Generator authorizes TC-S to facilitate REC sales to third-party purchasers.
            No custody of funds. Prototype only.
          </p>

          <div class="siggrid">
            <div>
              <div class="siglabel">Generator Signature</div>
              <canvas class="sigpad" id="ppaSigGen" width="420" height="140"></canvas>
              <div class="sigactions">
                <button type="button" class="btn tiny" data-clear="ppaSigGen">Clear</button>
              </div>
            </div>
            <div>
              <div class="siglabel">TC-S Representative</div>
              <canvas class="sigpad" id="ppaSigTcs" width="420" height="140"></canvas>
              <div class="sigactions">
                <button type="button" class="btn tiny" data-clear="ppaSigTcs">Clear</button>
              </div>
            </div>
          </div>

          <div class="actions end">
            <button type="button" class="btn" data-close="ppaModal">Cancel</button>
            <button type="submit" class="btn primary">Mock-Sign & Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- ========== REC PURCHASE AGREEMENT MODAL ========== -->
  <div class="modal hidden" id="recPaModal" aria-hidden="true">
    <div class="modal-card">
      <div class="modal-head">
        <h3>REC Purchase Agreement (Prototype)</h3>
        <button class="icon" data-close="recPaModal" aria-label="Close">✕</button>
      </div>
      <div class="modal-body">
        <form id="recPaForm">
          <div class="row">
            <label>Purchaser
              <input type="text" id="recBuyer" placeholder="Acme Corp" required>
            </label>
            <label>Generator
              <input type="text" id="recGenerator" required>
            </label>
            <label>Registry / Region
              <input type="text" id="recRegistry" placeholder="WREGIS / CAISO" required>
            </label>
          </div>

          <div class="row">
            <label>REC Quantity
              <input type="number" id="recQty" min="1" step="1" placeholder="550" required>
            </label>
            <label>Price ($/REC)
              <input type="number" id="recPriceUnit" min="0" step="0.01" placeholder="28.00" required>
            </label>
            <label>Base Price ($/REC)
              <input type="number" id="recBaseUnit" min="0" step="0.01" placeholder="20.00" required>
            </label>
          </div>

          <p class="small">
            Buyer agrees to purchase RECs from Generator. TC-S facilitates verification and registry transfer. Prototype only. No double-counting claims.
          </p>

          <div class="siggrid">
            <div>
              <div class="siglabel">Purchaser Signature</div>
              <canvas class="sigpad" id="recSigBuyer" width="420" height="140"></canvas>
              <div class="sigactions">
                <button type="button" class="btn tiny" data-clear="recSigBuyer">Clear</button>
              </div>
            </div>
            <div>
              <div class="siglabel">Generator Signature</div>
              <canvas class="sigpad" id="recSigGen" width="420" height="140"></canvas>
              <div class="sigactions">
                <button type="button" class="btn tiny" data-clear="recSigGen">Clear</button>
              </div>
            </div>
            <div>
              <div class="siglabel">TC-S Representative</div>
              <canvas class="sigpad" id="recSigTcs" width="420" height="140"></canvas>
              <div class="sigactions">
                <button type="button" class="btn tiny" data-clear="recSigTcs">Clear</button>
              </div>
            </div>
          </div>

          <div class="actions end">
            <button type="button" class="btn" data-close="recPaModal">Cancel</button>
            <button type="submit" class="btn primary">Mock-Sign & Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>

</body>
</html>