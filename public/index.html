<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TC-S Network Foundation Digital Artifact Marketplace</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Arial', sans-serif; 
            background: linear-gradient(135deg, #0057B8, #00695c);
            color: white;
            min-height: 100vh;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; margin-bottom: 40px; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; color: #FFC107; }
        .header p { font-size: 1.2em; opacity: 0.9; }
        .marketplace-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); 
            gap: 30px; 
            margin-top: 40px; 
        }
        .artifact-card { 
            background: rgba(255, 255, 255, 0.1); 
            backdrop-filter: blur(10px);
            border-radius: 15px; 
            padding: 25px; 
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }
        .artifact-card:hover { transform: translateY(-5px); }
        .artifact-title { font-size: 1.4em; margin-bottom: 10px; color: #FFC107; }
        .artifact-description { margin-bottom: 15px; opacity: 0.9; line-height: 1.5; }
        .artifact-meta { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 20px; 
        }
        .price { font-size: 1.3em; font-weight: bold; color: #4CAF50; }
        .category { 
            background: rgba(255, 193, 7, 0.3); 
            padding: 5px 15px; 
            border-radius: 20px; 
            font-size: 0.9em; 
        }
        .audio-player { 
            margin: 15px 0; 
            width: 100%; 
        }
        .audio-player audio { 
            width: 100%; 
            height: 40px; 
        }
        .purchase-btn { 
            width: 100%; 
            background: linear-gradient(135deg, #4CAF50, #45a049); 
            color: white; 
            border: none; 
            padding: 12px; 
            border-radius: 8px; 
            font-size: 1.1em; 
            cursor: pointer; 
            transition: opacity 0.3s;
        }
        .purchase-btn:hover { opacity: 0.9; }
        .stats { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 20px; 
            margin-bottom: 40px; 
        }
        .stat-card { 
            background: rgba(255, 255, 255, 0.1); 
            padding: 20px; 
            border-radius: 10px; 
            text-align: center; 
        }
        .stat-number { font-size: 2em; color: #FFC107; font-weight: bold; }
        .stat-label { opacity: 0.8; margin-top: 5px; }
        .loading { text-align: center; padding: 40px; }
        @media (max-width: 768px) {
            .header h1 { font-size: 2em; }
            .marketplace-grid { grid-template-columns: 1fr; }
            .artifact-meta { flex-direction: column; gap: 10px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸŒž TC-S Digital Artifact Marketplace</h1>
            <p>Solar-powered global economy â€¢ AI-curated digital artifacts â€¢ SOLAR token transactions</p>
        </div>

        <div class="stats" id="statsGrid">
            <div class="stat-card">
                <div class="stat-number" id="artifactCount">-</div>
                <div class="stat-label">Digital Artifacts</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalValue">-</div>
                <div class="stat-label">Total SOLAR Value</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="transactionCount">-</div>
                <div class="stat-label">Transactions</div>
            </div>
        </div>

        <div class="marketplace-grid" id="marketplaceGrid">
            <div class="loading">Loading marketplace artifacts...</div>
        </div>
    </div>

    <script>
        class MarketplaceApp {
            constructor() {
                this.artifacts = [];
                this.stats = {};
                this.init();
            }

            async init() {
                await this.loadStats();
                await this.loadArtifacts();
            }

            async loadStats() {
                try {
                    const response = await fetch('/api/market/stats');
                    if (response.ok) {
                        this.stats = await response.json();
                        this.updateStatsDisplay();
                    }
                } catch (error) {
                    console.log('Stats loading failed, using defaults');
                }
            }

            async loadArtifacts() {
                try {
                    const response = await fetch('/api/artifacts/available');
                    if (response.ok) {
                        const data = await response.json();
                        this.artifacts = data.artifacts || [];
                        this.displayArtifacts();
                    }
                } catch (error) {
                    console.log('Artifacts loading failed');
                    this.displayOfflineMessage();
                }
            }

            updateStatsDisplay() {
                document.getElementById('artifactCount').textContent = this.stats.totalArtifacts || 0;
                document.getElementById('totalValue').textContent = (this.stats.totalValue || 0) + ' SOLAR';
                document.getElementById('transactionCount').textContent = this.stats.totalTransactions || 0;
            }

            displayArtifacts() {
                const grid = document.getElementById('marketplaceGrid');
                
                if (this.artifacts.length === 0) {
                    grid.innerHTML = '<div class="loading">No artifacts available yet.</div>';
                    return;
                }

                grid.innerHTML = this.artifacts.map(artifact => `
                    <div class="artifact-card">
                        <div class="artifact-title">${this.escapeHtml(artifact.title)}</div>
                        <div class="artifact-description">${this.escapeHtml(artifact.description)}</div>
                        <div class="artifact-meta">
                            <span class="price">${artifact.price} SOLAR</span>
                            <span class="category">${artifact.category}</span>
                        </div>
                        ${artifact.category === 'audio' ? this.createAudioPlayer(artifact.filePath) : ''}
                        <button class="purchase-btn" onclick="app.purchaseArtifact('${artifact.id}')">
                            Purchase with SOLAR
                        </button>
                    </div>
                `).join('');
            }

            createAudioPlayer(filePath) {
                return `
                    <div class="audio-player">
                        <audio controls>
                            <source src="${filePath}" type="audio/mpeg">
                            Your browser does not support the audio element.
                        </audio>
                    </div>
                `;
            }

            displayOfflineMessage() {
                const grid = document.getElementById('marketplaceGrid');
                grid.innerHTML = `
                    <div class="loading">
                        <h3>ðŸŒž Marketplace Coming Online</h3>
                        <p>The TC-S Digital Artifact Marketplace is initializing. Please check back shortly.</p>
                    </div>
                `;
            }

            async purchaseArtifact(artifactId) {
                alert('Purchase system coming online! The TC-S marketplace with SOLAR tokens will be fully operational soon.');
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        // Initialize marketplace when page loads
        document.addEventListener('DOMContentLoaded', () => {
            window.app = new MarketplaceApp();
        });
    </script>
</body>
</html>