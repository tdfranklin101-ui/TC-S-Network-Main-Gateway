<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics - The Current-See</title>
    <link rel="stylesheet" href="css/common.css">
    <style>
        .analytics-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .metric-card {
            background: linear-gradient(135deg, rgba(255, 140, 0, 0.1), rgba(218, 165, 32, 0.1));
            border: 1px solid rgba(255, 140, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #ff8c00;
            margin: 10px 0;
        }
        .metric-label {
            font-size: 1.1em;
            color: #333;
            margin-bottom: 5px;
        }
        .metric-subtitle {
            font-size: 0.9em;
            color: #666;
        }
        .solar-counter {
            background: linear-gradient(45deg, #ff8c00, #daa520);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }
        .solar-value {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }
        .disclaimer {
            background: rgba(255, 140, 0, 0.1);
            border: 1px solid rgba(255, 140, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-size: 0.9em;
            color: #666;
        }
        .back-button {
            display: inline-block;
            background: linear-gradient(45deg, #ff8c00, #daa520);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            text-decoration: none;
            margin: 20px 0;
            transition: transform 0.2s;
        }
        .back-button:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="analytics-container">
        <h1>üåü Current-See Analytics Dashboard</h1>
        <p>Real-time platform metrics and solar energy tracking</p>
        
        <a href="/" class="back-button">‚Üê Back to Home</a>

        <div class="solar-counter">
            <div class="metric-label">Total Platform Energy Value</div>
            <div class="solar-value" id="total-energy-value">Loading...</div>
            <div class="metric-subtitle">Theoretical prototypical value in sustainable energy tokens</div>
        </div>

        <div class="metric-grid">
            <div class="metric-card">
                <div class="metric-label">Active Members</div>
                <div class="metric-value" id="member-count">19</div>
                <div class="metric-subtitle">Platform participants</div>
            </div>
            
            <div class="metric-card">
                <div class="metric-label">SOLAR Generated Today</div>
                <div class="metric-value" id="daily-solar">Loading...</div>
                <div class="metric-subtitle">Daily energy allocation</div>
            </div>
            
            <div class="metric-card">
                <div class="metric-label">Platform Uptime</div>
                <div class="metric-value" id="uptime">99.8%</div>
                <div class="metric-subtitle">Last 30 days</div>
            </div>
            
            <div class="metric-card">
                <div class="metric-label">Health Status</div>
                <div class="metric-value" id="health-status">üü¢</div>
                <div class="metric-subtitle">All systems operational</div>
            </div>
            
            <div class="metric-card">
                <div class="metric-label">Music Tracks</div>
                <div class="metric-value">13</div>
                <div class="metric-subtitle">Audio experiences available</div>
            </div>
            
            <div class="metric-card">
                <div class="metric-label">AI Assistant</div>
                <div class="metric-value">ü§ñ</div>
                <div class="metric-subtitle">Kid Solar - Active</div>
            </div>
        </div>

        <div class="disclaimer">
            <strong>Disclaimer:</strong> All monetary values and energy calculations represent theoretical prototypical values 
            for demonstration of a potential sustainable economic model. This platform is a conceptual prototype exploring 
            the intersection of renewable energy and economic systems.
        </div>

        <div style="text-align: center; margin: 30px 0;">
            <p>Analytics updated: <span id="last-updated">Loading...</span></p>
            <button onclick="refreshMetrics()" style="background: #ff8c00; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">
                Refresh Metrics
            </button>
        </div>
    </div>

    <script>
        // Solar counter animation
        function animateCounter(element, start, end, duration) {
            const startTime = performance.now();
            const range = end - start;
            
            function updateCounter(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const current = start + (range * progress);
                
                if (element.id === 'total-energy-value') {
                    element.textContent = '$' + Math.floor(current).toLocaleString();
                } else {
                    element.textContent = Math.floor(current).toLocaleString();
                }
                
                if (progress < 1) {
                    requestAnimationFrame(updateCounter);
                }
            }
            
            requestAnimationFrame(updateCounter);
        }

        // Calculate daily SOLAR based on current date
        function calculateDailySolar() {
            const startDate = new Date('2025-04-07');
            const currentDate = new Date();
            const daysSinceStart = Math.floor((currentDate - startDate) / (1000 * 60 * 60 * 24));
            const membersCount = 19;
            const dailySolarPerMember = 1;
            
            return daysSinceStart * membersCount * dailySolarPerMember;
        }

        // Update metrics
        function updateMetrics() {
            const totalSolar = calculateDailySolar();
            const energyValue = totalSolar * 4913 * 0.12; // kWh * average cost per kWh
            
            // Animate counters
            animateCounter(document.getElementById('total-energy-value'), 0, energyValue, 2000);
            animateCounter(document.getElementById('daily-solar'), 0, totalSolar, 1500);
            
            // Update timestamp
            document.getElementById('last-updated').textContent = new Date().toLocaleString();
            
            // Check server health
            fetch('/health')
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'healthy') {
                        document.getElementById('health-status').textContent = 'üü¢';
                    }
                })
                .catch(() => {
                    document.getElementById('health-status').textContent = 'üü°';
                });
        }

        function refreshMetrics() {
            updateMetrics();
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', updateMetrics);
        
        // Auto-refresh every 30 seconds
        setInterval(updateMetrics, 30000);
    </script>
</body>
</html>